(this["webpackJsonpmesto-react"]=this["webpackJsonpmesto-react"]||[]).push([[0],{16:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),o=a(7),c=a.n(o),s=(a(6),a(10)),i=a(2),u=a.p+"static/media/logo.03b78ada.svg",l=a(0);var p=function(){return Object(l.jsx)("header",{className:"header",children:Object(l.jsx)("img",{className:"header__logo",src:u,alt:"\u043b\u043e\u0433\u043e"})})},d=a.p+"static/media/pen_avatar.a086f758.svg",m=r.a.createContext();var _=function(e){var t=r.a.useContext(m),a=e.cardOwner===t.id,n="element__trash ".concat(a?"element__trash_visible":"element__trash_hidden"),o=e.likesArr.some((function(e){return e._id===t.id})),c="element__heart ".concat(o?"element__heart_anabled":"");return Object(l.jsxs)("article",{className:"element",children:[Object(l.jsxs)("div",{children:[Object(l.jsx)("img",{className:"element__picture",src:e.url,onClick:function(){e.onCardClick({url:e.url,name:e.name}),e.clickOnImage()},alt:e.name}),Object(l.jsx)("button",{className:n,onClick:function(){e.onCardDelete(e)},type:"button","aria-label":"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u043a\u0430\u0440\u0442\u043e\u0447\u043a\u0443"})]}),Object(l.jsxs)("div",{className:"element__container",children:[Object(l.jsx)("h3",{className:"element__title",children:e.name}),Object(l.jsxs)("div",{className:"element__container_likes",children:[Object(l.jsx)("button",{className:c,onClick:function(){e.onCardLike(e)},type:"button","aria-label":"\u041b\u0430\u0439\u043a"}),Object(l.jsx)("p",{className:"element__likes",children:e.likes})]})]})]})};var f=function(e){var t=r.a.useContext(m);return Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)("main",{className:"content",children:Object(l.jsxs)("section",{className:"profile",children:[Object(l.jsxs)("div",{className:"profile__container",children:[Object(l.jsxs)("div",{className:"profile__avatar-container",children:[Object(l.jsx)("img",{className:"profile__avatar",onClick:e.onEditAvatar,src:t.avatar,alt:"\u0430\u0432\u0430\u0442\u0430\u0440\u043a\u0430"}),Object(l.jsx)("img",{className:"profile__avatar-pen",onClick:e.onEditAvatar,src:d,alt:"\u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0430 \u0441\u043c\u0435\u043d\u044b \u043f\u0440\u043e\u0444\u0438\u043b\u044f"})]}),Object(l.jsx)("h1",{className:"profile__name",children:t.name}),Object(l.jsx)("button",{className:"profile__edit-button",onClick:e.onEditProfile,type:"button","aria-label":"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c"}),Object(l.jsx)("p",{className:"profile__profession",children:t.about})]}),Object(l.jsx)("button",{className:"profile__add-button",onClick:e.onAddPlace,type:"submit","aria-label":"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043c\u0435\u0441\u0442\u043e"})]})}),Object(l.jsx)(l.Fragment,{children:Object(l.jsx)("div",{className:"elements",children:e.cards.map((function(t){return Object(l.jsx)(_,{onCardDelete:e.onCardDelete,onCardLike:e.onCardLike,name:t.name,url:t.link,likes:t.likes.length,likesArr:t.likes,onCardClick:e.setSelectedCardOn,clickOnImage:e.onImage,idCard:t._id,cardOwner:t.owner._id},t._id)}))})})]})};var h=function(){return Object(l.jsx)("footer",{className:"footer",children:Object(l.jsx)("p",{className:"footer__text",children:"\xa92020 Mesto Russia"})})};var b=function(e){return Object(l.jsx)("div",{id:"picture",className:"popup ".concat(e.isOpen?"popup_active":""),children:Object(l.jsxs)("div",{className:"popup__container popup__container-picture",children:[Object(l.jsx)("button",{onClick:e.onClose,className:"popup__close-button popup__close-button_position",type:"button","aria-label":"\u0417\u0430\u043a\u0440\u044b\u0442\u044c \u043e\u043a\u043d\u043e",id:"close_button_picture"}),Object(l.jsx)("img",{className:"popup__picture",src:e.card.url,alt:"\u0420\u0430\u0437\u0432\u0435\u0440\u043d\u0443\u0442\u0430\u044f \u043a\u0430\u0440\u0442\u0438\u043a\u0430"}),Object(l.jsx)("p",{className:"popup__sign",children:e.card.name})]})})},j=a(8),v=a(9),O=new(function(){function e(t){Object(j.a)(this,e),this._url=t.url,this._headers=t.headers}return Object(v.a)(e,[{key:"getUserInfo",value:function(){var e=this;return fetch(this._url+"users/me",{method:"GET",headers:this._headers}).then((function(t){return e._getResponseData(t)}))}},{key:"postUserInfo",value:function(e,t){var a=this;return fetch(this._url+"users/me",{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e,about:t})}).then((function(e){return a._getResponseData(e)}))}},{key:"getAllCards",value:function(){var e=this;return fetch(this._url+"cards",{method:"GET",headers:this._headers}).then((function(t){return e._getResponseData(t)}))}},{key:"addNewCard",value:function(e,t){var a=this;return fetch(this._url+"cards",{method:"POST",headers:this._headers,body:JSON.stringify({name:e,link:t})}).then((function(e){return a._getResponseData(e)}))}},{key:"removeCard",value:function(e){var t=this;return fetch("".concat(this._url,"cards/").concat(e),{method:"DELETE",headers:this._headers}).then((function(e){return t._getResponseData(e)}))}},{key:"setLike",value:function(e){var t=this;return fetch("".concat(this._url,"cards/likes/").concat(e),{method:"PUT",headers:this._headers}).then((function(e){return t._getResponseData(e)}))}},{key:"deleteLike",value:function(e){var t=this;return fetch("".concat(this._url,"cards/likes/").concat(e),{method:"DELETE",headers:this._headers}).then((function(e){return t._getResponseData(e)}))}},{key:"userAvatarUpdate",value:function(e){var t=this;return fetch(this._url+"users/me/avatar",{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then((function(e){return t._getResponseData(e)}))}},{key:"_getResponseData",value:function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}},{key:"changeLikeCardStatus",value:function(e,t){var a=this;return fetch("".concat(this._url,"cards/likes/").concat(e),{method:t?"PUT":"DELETE",headers:this._headers}).then((function(e){return a._getResponseData(e)}))}}]),e}())({url:"https://mesto.nomoreparties.co/v1/cohort-20/",headers:{authorization:"9c0a4b23-790f-477e-8923-142dbfd6589d","Content-Type":"application/json"}});var x=function(e){return Object(l.jsx)("div",{className:"popup popup_type_".concat(e.name," ").concat(e.isOpen?"popup_active":""),children:Object(l.jsxs)("div",{className:"popup__container",children:[Object(l.jsx)("button",{className:"popup__close-button",onClick:e.onClose,type:"button","aria-label":"\u0417\u0430\u043a\u0440\u044b\u0442\u044c \u043e\u043a\u043d\u043e",id:"close_button_edit"}),Object(l.jsx)("h3",{className:"popup__title",children:e.title}),Object(l.jsx)("form",{onSubmit:e.submit,className:"popup__form-input",name:e.formName,id:e.formId,novalidate:!0,method:"POST",children:e.children}),Object(l.jsx)("button",{onClick:e.click,type:"submit",className:"popup__add-button popup__submit",id:e.idButton,"aria-label":e.ariaLabel,children:e.buttonText})]})})};var g=function(e){var t=r.a.useContext(m),a=r.a.useState(""),n=Object(i.a)(a,2),o=n[0],c=n[1],s=r.a.useState(""),u=Object(i.a)(s,2),p=u[0],d=u[1];function _(t){t.preventDefault(),e.onUpdateUser({name:o,about:p})}return r.a.useEffect((function(){c(t.name),d(t.about)}),[t]),Object(l.jsxs)(x,{buttonText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",name:e.name,isOpen:e.isOpen,onClose:e.onClose,title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",submit:_,click:_,children:[Object(l.jsx)("input",{className:"popup__form popup__form_info_name",value:o,onChange:function(e){c(e.target.value)},type:"text",name:"name",required:!0,id:"popup__form-error_name",minLength:"2",maxLength:"40",placeholder:"\u0418\u043c\u044f"}),Object(l.jsx)("span",{className:"popup__form-error popup__form-error_name"}),Object(l.jsx)("input",{className:"popup__form popup__form_info_job",value:p,onChange:function(e){d(e.target.value)},type:"text",name:"job",required:!0,minLength:"2",maxLength:"200",id:"popup__form-error_job",placeholder:"\u041f\u0440\u043e\u0444\u0435\u0441\u0441\u0438\u044f"}),Object(l.jsx)("span",{className:"popup__form-error popup__form-error_job"})]})};var C=function(e){var t=r.a.useState(" "),a=Object(i.a)(t,2),n=a[0],o=a[1],c=r.a.useState(" "),s=Object(i.a)(c,2),u=s[0],p=s[1],d=r.a.useState(!1),_=Object(i.a)(d,2),f=(_[0],_[1]),h=r.a.useContext(m),b=/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/;function j(t){t.preventDefault(),e.onUpdateAvatar(n)}return r.a.useEffect((function(){o(h.avatar),p("")}),[h]),Object(l.jsxs)(x,{buttonText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",name:e.name,isOpen:e.isOpen,onClose:e.onClose,title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",submit:j,click:j,children:[Object(l.jsx)("input",{onChange:function(e){o(e.target.value),p(e.target.value),b.test(n)?f(!0):f(!1)},value:u,className:"popup__form popup__form-input-error popup__form_info_name-avatar",type:"url",name:"avatar",placeholder:"\u0412\u0432\u0435\u0441\u0442\u0438 url \u0430\u0432\u0430\u0442\u0430\u0440\u0430",id:"popup__form-error_name-avatar",required:!0}),Object(l.jsx)("span",{className:"popup__form-error popup__form-error_name-avatar"})]})};var k=function(e){var t=r.a.useState(""),a=Object(i.a)(t,2),n=a[0],o=a[1],c=r.a.useState(""),s=Object(i.a)(c,2),u=s[0],p=s[1],d=r.a.useState(""),m=Object(i.a)(d,2),_=m[0],f=m[1],h=r.a.useState(""),b=Object(i.a)(h,2),j=b[0],v=b[1];function O(t){t.preventDefault(),e.onAddPlace(n,u),f(""),v("")}return Object(l.jsxs)(x,{buttonText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",name:e.name,isOpen:e.isOpen,onClose:e.onClose,title:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043c\u0435\u0441\u0442\u043e",submit:O,click:O,children:[Object(l.jsx)("input",{onChange:function(e){o(e.target.value),f(e.target.value)},value:_,className:"popup__form popup__form-input-error popup__form_info_name-picture",type:"text",name:"name_pic",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",id:"popup__form-error_name-picture",minLength:"2",maxLength:"30",required:!0}),Object(l.jsx)("span",{className:"popup__form-error popup__form-error_name-picture"}),Object(l.jsx)("input",{onChange:function(e){p(e.target.value),v(e.target.value)},value:j,className:"popup__form popup__form-input-error popup__form_info_url",type:"url",name:"link",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",id:"popup__form-error_url",required:!0}),Object(l.jsx)("span",{className:"popup__form-error popup__form-error_url"})]})};var N=function(){var e=r.a.useState(!1),t=Object(i.a)(e,2),a=t[0],n=t[1],o=r.a.useState(!1),c=Object(i.a)(o,2),u=c[0],d=c[1],_=r.a.useState(!1),j=Object(i.a)(_,2),v=j[0],x=j[1],N=r.a.useState(""),y=Object(i.a)(N,2),S=y[0],E=y[1],L=r.a.useState(!1),D=Object(i.a)(L,2),T=D[0],A=D[1],P=r.a.useState({name:"",about:"",avatar:"",id:""}),U=Object(i.a)(P,2),w=U[0],I=U[1],R=r.a.useState([]),F=Object(i.a)(R,2),q=F[0],B=F[1];function J(){x(!1),n(!1),d(!1),E(""),A(!1)}return r.a.useEffect((function(){function e(e){e.target.classList.contains("popup_active")&&J()}function t(e){"Escape"===e.key&&J()}return document.addEventListener("keydown",t),document.addEventListener("click",e),function(){document.removeEventListener("keydown",t),document.removeEventListener("click",e)}})),r.a.useEffect((function(){O.getAllCards().then((function(e){B(e)})).catch((function(e){console.log("\u0443\u043f\u0441, \u0432\u043e\u0437\u043d\u0438\u043a\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430! ".concat(e,"}"))}))}),[]),r.a.useEffect((function(){O.getUserInfo().then((function(e){I({name:e.name,about:e.about,avatar:e.avatar,id:e._id})})).catch((function(e){console.log("\u0443\u043f\u0441, \u0432\u043e\u0437\u043d\u0438\u043a\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430! ".concat(e,"}"))}))}),[]),Object(l.jsx)(m.Provider,{value:w,children:Object(l.jsx)("body",{className:"background",children:Object(l.jsxs)("div",{className:"page",children:[Object(l.jsx)(p,{}),Object(l.jsx)(f,{onEditProfile:function(){n(!0)},onEditAvatar:function(){x(!0)},onAddPlace:function(){d(!0)},setSelectedCardOn:E,onImage:function(){A(!0)},card:S,cards:q,onCardLike:function(e){var t=e.likesArr.some((function(e){return e._id===w.id}));O.changeLikeCardStatus(e.idCard,!t).then((function(t){B((function(a){return a.map((function(a){return a._id===e.idCard?t:a}))}))})).catch((function(e){console.log("\u0443\u043f\u0441, \u0432\u043e\u0437\u043d\u0438\u043a\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430! ".concat(e,"}"))}))},onCardDelete:function(e){O.removeCard(e.idCard).then((function(){B((function(t){return t.filter((function(t){return t._id!==e.idCard}))}))})).catch((function(e){console.log("\u0443\u043f\u0441, \u0432\u043e\u0437\u043d\u0438\u043a\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430! ".concat(e))}))}}),Object(l.jsx)(C,{onUpdateAvatar:function(e){O.userAvatarUpdate(e).then((function(e){I({name:e.name,about:e.about,avatar:e.avatar,id:e._id})})).catch((function(e){console.log("\u0443\u043f\u0441, \u0432\u043e\u0437\u043d\u0438\u043a\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430! ".concat(e,"}"))})),J()},isOpen:v,onClose:J}),Object(l.jsx)(g,{onUpdateUser:function(e){var t=e.name,a=e.about;O.postUserInfo(t,a).then((function(e){I({name:e.name,about:e.about,avatar:e.avatar,id:e._id})})).catch((function(e){console.log("\u0443\u043f\u0441, \u0432\u043e\u0437\u043d\u0438\u043a\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430! ".concat(e,"}"))})),J()},isOpen:a,onClose:J}),Object(l.jsx)(k,{formName:"form_add",formId:"form_add",idButton:"addButton","aria-Label":"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043a\u0430\u0440\u0442\u043e\u0447\u043a\u0443",buttonText:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c",name:"form_add",title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",isOpen:u,onClose:J,onAddPlace:function(e,t){O.addNewCard(e,t).then((function(e){B([e].concat(Object(s.a)(q)))})).catch((function(e){console.log("\u0443\u043f\u0441, \u0432\u043e\u0437\u043d\u0438\u043a\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430! ".concat(e))})),J()}}),Object(l.jsx)(b,{card:S,isOpen:T,onClose:J}),Object(l.jsx)(h,{})]})})})},y=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,17)).then((function(t){var a=t.getCLS,n=t.getFID,r=t.getFCP,o=t.getLCP,c=t.getTTFB;a(e),n(e),r(e),o(e),c(e)}))};c.a.render(Object(l.jsx)(r.a.StrictMode,{children:Object(l.jsx)(N,{})}),document.getElementById("root")),y()},6:function(e,t,a){}},[[16,1,2]]]);
//# sourceMappingURL=main.210f69a4.chunk.js.map